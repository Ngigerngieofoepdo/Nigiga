local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local toolsFolder = workspace:WaitForChild("Map"):WaitForChild("Ignore"):WaitForChild("Tools")
local remote = workspace.Services:WaitForChild("PickupTool")

-- Create Screen GUI
local screenGui = Instance.new("ScreenGui", playerGui)
screenGui.Name = "ToolPickerGui"

-- Create Main Button to Open Scroll Frame
local openButton = Instance.new("TextButton", screenGui)
openButton.Size = UDim2.new(0.2, 0, 0.1, 0)
openButton.Position = UDim2.new(0.4, 0, 0.1, 0)
openButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Black background
openButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text
openButton.Text = "Show Tools"

-- Create Scroll Frame
local scrollingFrame = Instance.new("Frame", screenGui)
scrollingFrame.Size = UDim2.new(0.5, 0, 0.5, 0)
scrollingFrame.Position = UDim2.new(0.25, 0, 0.25, 0)
scrollingFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Black background
scrollingFrame.Visible = false

-- Create UI List Layout for Scroll Frame
local uiListLayout = Instance.new("UIListLayout", scrollingFrame)
uiListLayout.FillDirection = Enum.FillDirection.Vertical
uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
uiListLayout.Padding = UDim.new(0, 5)

-- Create Close Button
local closeButton = Instance.new("TextButton", scrollingFrame)
closeButton.Size = UDim2.new(0.2, 0, 0.1, 0)
closeButton.Position = UDim2.new(0.4, 0, 0, 0)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0) -- Red background
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text
closeButton.Text = "Close"

-- Function to create buttons for each tool
local function createToolButton(tool)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, 0, 0, 50)
    button.Text = tool.Name
    button.BackgroundColor3 = Color3.fromRGB(50, 50, 50) -- Dark grey
    button.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text
    button.Parent = scrollingFrame

    button.MouseButton1Click:Connect(function()
        -- Store the selected tool name for teleportation
        screenGui:SetAttribute("SelectedTool", tool.Name)
    end)
end

-- Populate the scrolling frame with tools
for _, tool in ipairs(toolsFolder:GetChildren()) do
    if tool:IsA("Tool") then
        createToolButton(tool)
    end
end

-- Button to open the scroll frame
openButton.MouseButton1Click:Connect(function()
    scrollingFrame.Visible = true
end)

-- Close button functionality
closeButton.MouseButton1Click:Connect(function()
    scrollingFrame.Visible = false
end)

-- Create TP and Get Button
local tpButton = Instance.new("TextButton", screenGui)
tpButton.Size = UDim2.new(0.2, 0, 0.1, 0)
tpButton.Position = UDim2.new(0.4, 0, 0.7, 0)
tpButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255) -- Blue background
tpButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text
tpButton.Text = "TP and Get"

-- TP and Get functionality
tpButton.MouseButton1Click:Connect(function()
    local selectedToolName = screenGui:GetAttribute("SelectedTool")
    local selectedTool = toolsFolder:FindFirstChild(selectedToolName)
    
    if selectedTool then
        local args = {
            [1] = "#" .. selectedTool.Name,
            [2] = selectedTool.Name .. "#" .. selectedTool:GetAttribute("ID") -- Assuming there's an ID attribute or similar
        }
        remote:InvokeServer(unpack(args))
        player.Character.HumanoidRootPart.CFrame = selectedTool.CFrame -- Teleport to the tool
    else
        warn("No tool selected or tool not found.")
    end
end)

print("Tool Picker GUI created successfully!")
